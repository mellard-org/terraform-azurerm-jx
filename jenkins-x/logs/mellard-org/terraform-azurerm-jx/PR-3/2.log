
Showing logs for build [32mmellard-org-terraform-azurerm-j-s77mc-2[0m stage [32mci[0m and container [32mcredential-initializer[0m
{"level":"info","ts":1598868934.9175913,"caller":"creds-init/main.go:44","msg":"Credentials initialized."}

Showing logs for build [32mmellard-org-terraform-azurerm-j-s77mc-2[0m stage [32mci[0m and container [32mworking-dir-initializer[0m

Showing logs for build [32mmellard-org-terraform-azurerm-j-s77mc-2[0m stage [32mci[0m and container [32mplace-tools[0m

Showing logs for build [32mmellard-org-terraform-azurerm-j-s77mc-2[0m stage [32mci[0m and container [32mstep-git-source-mellard-org-terraform-azurerm-j-s77mc-b4cr4[0m
{"level":"info","ts":1598868949.8581765,"caller":"git/git.go:105","msg":"Successfully cloned https://github.com/mellard-org/terraform-azurerm-**.git @ master in path /workspace/source"}
{"level":"warn","ts":1598868949.85826,"caller":"git/git.go:152","msg":"Unexpected error: creating symlink: symlink /tekton/home/.ssh /root/.ssh: file exists"}
{"level":"info","ts":1598868949.8998933,"caller":"git/git.go:133","msg":"Successfully initialized and updated submodules in path /workspace/source"}

Showing logs for build [32mmellard-org-terraform-azurerm-j-s77mc-2[0m stage [32mci[0m and container [32mstep-setup-builder-home[0m

Showing logs for build [32mmellard-org-terraform-azurerm-j-s77mc-2[0m stage [32mci[0m and container [32mstep-git-merge[0m
Using SHAs from PULL_REFS=master:5a446bbcb8b158cdbbc2ce90534f0d4eccdeea36,3:848ef72adcd13858297a56eddb889a3e713b077f
DEBUG: JX_LOG_LEVEL=error LC_ALL=C git fetch origin --unshallow 848ef72adcd13858297a56eddb889a3e713b077f: 5a446bbcb8b158cdbbc2ce90534f0d4eccdeea36:
DEBUG: ran git fetch --unshallow origin 848ef72adcd13858297a56eddb889a3e713b077f: 5a446bbcb8b158cdbbc2ce90534f0d4eccdeea36: in 
DEBUG: LC_ALL=C JX_LOG_LEVEL=error git branch
DEBUG: LC_ALL=C JX_LOG_LEVEL=error git checkout master
DEBUG: ran git checkout master in 
DEBUG: LC_ALL=C JX_LOG_LEVEL=error git reset --hard 5a446bbcb8b158cdbbc2ce90534f0d4eccdeea36
DEBUG: ran git reset --hard 5a446bbcb8b158cdbbc2ce90534f0d4eccdeea36 in 
DEBUG: LC_ALL=C JX_LOG_LEVEL=error git clean -fd .
DEBUG: ran clean --force -d . in 
DEBUG: LC_ALL=C JX_LOG_LEVEL=error git merge 848ef72adcd13858297a56eddb889a3e713b077f
DEBUG: ran git merge 848ef72adcd13858297a56eddb889a3e713b077f in 
DEBUG: LC_ALL=C JX_LOG_LEVEL=error git log --format=%H%x1f%an%x1f%ae%x1f%cn%x1f%ce%x1f%s%n%b%x1e 5a446bbcb8b158cdbbc2ce90534f0d4eccdeea36..HEAD
Merged SHA 848ef72adcd13858297a56eddb889a3e713b077f with commit message 'feat: Add in Key Vault test' into base branch master
Merged SHA c68af34f36705d1a0c12e1035c1c6d1828de0d7d with commit message 'feat: Re-enabling CI pipeline' into base branch master

Showing logs for build [32mmellard-org-terraform-azurerm-j-s77mc-2[0m stage [32mci[0m and container [32mstep-terraform-lint[0m
terraform init
[0m[1mInitializing modules...[0m
- backup in modules/backup
- cluster in modules/cluster
- dns in modules/dns
- registry in modules/registry
- vault in modules/vault
- vnet in modules/vnet

[0m[1mInitializing the backend...[0m

[0m[1mInitializing provider plugins...[0m
- Checking for available provider plugins...
- Downloading plugin for provider "random" (hashicorp/random) 2.3.0...
- Downloading plugin for provider "azurerm" (hashicorp/azurerm) 2.25.0...
- Downloading plugin for provider "azuread" (hashicorp/azuread) 0.11.0...
- Downloading plugin for provider "kubernetes" (hashicorp/kubernetes) 1.12.0...

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
terraform version
Terraform v0.12.17
+ provider.azuread v0.11.0
+ provider.azurerm v2.25.0
+ provider.kubernetes v1.12.0
+ provider.random v2.3.0

Your version of Terraform is out of date! The latest version
is 0.13.1. You can update by downloading from https://www.terraform.io/downloads.html
terraform fmt -check -diff -recursive
terraform validate
[32m[1mSuccess![0m The configuration is valid.
[0m

Showing logs for build [32mmellard-org-terraform-azurerm-j-s77mc-2[0m stage [32mci[0m and container [32mstep-terratest[0m
GO111MODULE=on go test -failfast -timeout 1h -parallel 8 -count=1 -v ./...
go: downloading github.com/Azure/azure-sdk-for-go v45.1.0+incompatible
go: downloading k8s.io/api v0.18.3
go: downloading github.com/Azure/azure-storage-blob-go v0.10.0
go: downloading k8s.io/apimachinery v0.18.3
go: downloading github.com/gruntwork-io/terratest v0.28.13
go: downloading github.com/Azure/go-autorest v14.2.0+incompatible
go: downloading k8s.io/client-go v0.18.3
go: downloading github.com/stretchr/testify v1.6.1
go: extracting github.com/Azure/go-autorest v14.2.0+incompatible
go: downloading github.com/Azure/go-autorest/autorest v0.11.4
go: extracting github.com/stretchr/testify v1.6.1
go: extracting github.com/Azure/azure-storage-blob-go v0.10.0
go: extracting github.com/Azure/go-autorest/autorest v0.11.4
go: downloading gopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c
go: downloading github.com/Azure/go-autorest/autorest/adal v0.9.2
go: extracting gopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c
go: extracting github.com/Azure/go-autorest/autorest/adal v0.9.2
go: downloading github.com/pmezard/go-difflib v1.0.0
go: downloading github.com/dgrijalva/jwt-go v3.2.0+incompatible
go: extracting github.com/dgrijalva/jwt-go v3.2.0+incompatible
go: extracting github.com/pmezard/go-difflib v1.0.0
go: downloading golang.org/x/crypto v0.0.0-20200728195943-123391ffb6de
go: downloading github.com/davecgh/go-spew v1.1.1
go: extracting github.com/davecgh/go-spew v1.1.1
go: downloading github.com/google/uuid v1.1.1
go: extracting github.com/google/uuid v1.1.1
go: extracting golang.org/x/crypto v0.0.0-20200728195943-123391ffb6de
go: extracting k8s.io/apimachinery v0.18.3
go: downloading github.com/Azure/go-autorest/logger v0.2.0
go: extracting k8s.io/client-go v0.18.3
go: extracting github.com/Azure/go-autorest/logger v0.2.0
go: downloading github.com/Azure/go-autorest/autorest/date v0.3.0
go: extracting github.com/Azure/go-autorest/autorest/date v0.3.0
go: downloading github.com/Azure/go-autorest/autorest/azure/auth v0.4.2
go: downloading github.com/gogo/protobuf v1.3.1
go: extracting github.com/gruntwork-io/terratest v0.28.13
go: extracting github.com/Azure/go-autorest/autorest/azure/auth v0.4.2
go: downloading github.com/otiai10/copy v1.2.0
go: extracting k8s.io/api v0.18.3
go: extracting github.com/otiai10/copy v1.2.0
go: downloading github.com/gruntwork-io/gruntwork-cli v0.5.1
go: extracting github.com/gogo/protobuf v1.3.1
go: extracting github.com/gruntwork-io/gruntwork-cli v0.5.1
go: downloading github.com/aws/aws-sdk-go v1.27.1
go: downloading github.com/Azure/go-autorest/autorest/azure/cli v0.3.1
go: downloading github.com/Azure/go-autorest/tracing v0.6.0
go: downloading gopkg.in/inf.v0 v0.9.1
go: extracting github.com/Azure/go-autorest/tracing v0.6.0
go: extracting gopkg.in/inf.v0 v0.9.1
go: extracting github.com/Azure/go-autorest/autorest/azure/cli v0.3.1
go: extracting github.com/aws/aws-sdk-go v1.27.1
go: downloading sigs.k8s.io/structured-merge-diff v1.0.1-0.20191108220359-b1b620dd3f06
go: downloading github.com/dimchansky/utfbom v1.1.0
go: downloading github.com/mitchellh/go-homedir v1.1.0
go: downloading golang.org/x/oauth2 v0.0.0-20200107190931-bf48bf16ab8d
go: downloading golang.org/x/net v0.0.0-20191209160850-c0dbc17a3553
go: extracting golang.org/x/oauth2 v0.0.0-20200107190931-bf48bf16ab8d
go: extracting github.com/dimchansky/utfbom v1.1.0
go: extracting sigs.k8s.io/structured-merge-diff v1.0.1-0.20191108220359-b1b620dd3f06
go: extracting github.com/mitchellh/go-homedir v1.1.0
go: downloading github.com/golang/protobuf v1.3.2
go: downloading sigs.k8s.io/structured-merge-diff/v3 v3.0.0
go: downloading github.com/pquerna/otp v1.2.0
go: extracting github.com/pquerna/otp v1.2.0
go: downloading github.com/googleapis/gnostic v0.3.1
go: extracting github.com/golang/protobuf v1.3.2
go: extracting sigs.k8s.io/structured-merge-diff/v3 v3.0.0
go: extracting golang.org/x/net v0.0.0-20191209160850-c0dbc17a3553
go: downloading github.com/Azure/azure-pipeline-go v0.2.2
go: extracting github.com/googleapis/gnostic v0.3.1
go: downloading sigs.k8s.io/yaml v1.2.0
go: downloading github.com/go-sql-driver/mysql v1.4.1
go: extracting github.com/Azure/azure-pipeline-go v0.2.2
go: downloading gopkg.in/yaml.v2 v2.2.8
go: downloading github.com/imdario/mergo v0.3.7
go: extracting sigs.k8s.io/yaml v1.2.0
go: downloading k8s.io/utils v0.0.0-20200324210504-a9aa75ae1b89
go: extracting github.com/go-sql-driver/mysql v1.4.1
go: extracting gopkg.in/yaml.v2 v2.2.8
go: downloading golang.org/x/time v0.0.0-20190308202827-9d24e82272b4
go: downloading github.com/google/gofuzz v1.1.0
go: extracting github.com/imdario/mergo v0.3.7
go: downloading github.com/urfave/cli v1.22.1
go: extracting golang.org/x/time v0.0.0-20190308202827-9d24e82272b4
go: downloading github.com/modern-go/reflect2 v1.0.1
go: extracting github.com/urfave/cli v1.22.1
go: extracting github.com/modern-go/reflect2 v1.0.1
go: downloading github.com/modern-go/concurrent v0.0.0-20180306012644-bacd9c7ef1dd
go: downloading github.com/boombuler/barcode v1.0.1-0.20190219062509-6c824513bacc
go: extracting k8s.io/utils v0.0.0-20200324210504-a9aa75ae1b89
go: extracting github.com/modern-go/concurrent v0.0.0-20180306012644-bacd9c7ef1dd
go: downloading github.com/json-iterator/go v1.1.8
go: extracting github.com/google/gofuzz v1.1.0
go: downloading github.com/jmespath/go-jmespath v0.0.0-20180206201540-c2b33e8439af
go: downloading github.com/go-errors/errors v1.0.2-0.20180813162953-d98b870cc4e0
go: extracting github.com/boombuler/barcode v1.0.1-0.20190219062509-6c824513bacc
go: extracting github.com/go-errors/errors v1.0.2-0.20180813162953-d98b870cc4e0
go: downloading github.com/mattn/go-ieproxy v0.0.0-20190702010315-6dee0af9227d
go: downloading github.com/spf13/pflag v1.0.5
go: extracting github.com/spf13/pflag v1.0.5
go: extracting github.com/jmespath/go-jmespath v0.0.0-20180206201540-c2b33e8439af
go: downloading k8s.io/klog v1.0.0
go: extracting github.com/json-iterator/go v1.1.8
go: downloading golang.org/x/sys v0.0.0-20200107162124-548cf772de50
go: extracting github.com/mattn/go-ieproxy v0.0.0-20190702010315-6dee0af9227d
go: downloading github.com/cpuguy83/go-md2man v1.0.10
go: downloading cloud.google.com/go v0.51.0
go: extracting k8s.io/klog v1.0.0
go: downloading github.com/docker/spdystream v0.0.0-20181023171402-6480d4af844c
go: extracting github.com/cpuguy83/go-md2man v1.0.10
go: downloading github.com/cpuguy83/go-md2man/v2 v2.0.0
go: extracting github.com/cpuguy83/go-md2man/v2 v2.0.0
go: downloading golang.org/x/text v0.3.2
go: extracting github.com/docker/spdystream v0.0.0-20181023171402-6480d4af844c
go: extracting cloud.google.com/go v0.51.0
go: extracting golang.org/x/sys v0.0.0-20200107162124-548cf772de50
go: extracting github.com/Azure/azure-sdk-for-go v45.1.0+incompatible
go: downloading github.com/russross/blackfriday v1.5.2
go: extracting github.com/russross/blackfriday v1.5.2
go: downloading github.com/russross/blackfriday/v2 v2.0.1
go: extracting github.com/russross/blackfriday/v2 v2.0.1
go: downloading github.com/shurcooL/sanitized_anchor_name v1.0.0
go: extracting golang.org/x/text v0.3.2
go: extracting github.com/shurcooL/sanitized_anchor_name v1.0.0
go: downloading github.com/Azure/go-autorest/autorest/to v0.3.0
go: downloading github.com/Azure/go-autorest/autorest/validation v0.2.0
go: extracting github.com/Azure/go-autorest/autorest/to v0.3.0
go: extracting github.com/Azure/go-autorest/autorest/validation v0.2.0
go: finding github.com/Azure/azure-sdk-for-go v45.1.0+incompatible
go: finding github.com/Azure/azure-storage-blob-go v0.10.0
go: finding github.com/Azure/go-autorest/autorest/adal v0.9.2
go: finding github.com/Azure/go-autorest/autorest/azure/auth v0.4.2
go: finding github.com/google/uuid v1.1.1
go: finding github.com/Azure/go-autorest/autorest v0.11.4
go: finding github.com/gruntwork-io/terratest v0.28.13
go: finding github.com/otiai10/copy v1.2.0
go: finding github.com/Azure/go-autorest/autorest/date v0.3.0
go: finding github.com/stretchr/testify v1.6.1
go: finding github.com/Azure/go-autorest/autorest/to v0.3.0
go: finding github.com/Azure/go-autorest/tracing v0.6.0
go: finding github.com/Azure/go-autorest/autorest/validation v0.2.0
go: finding k8s.io/api v0.18.3
go: finding github.com/Azure/azure-pipeline-go v0.2.2
go: finding k8s.io/apimachinery v0.18.3
go: finding k8s.io/client-go v0.18.3
go: finding github.com/gogo/protobuf v1.3.1
go: finding github.com/davecgh/go-spew v1.1.1
go: finding github.com/pmezard/go-difflib v1.0.0
go: finding golang.org/x/sys v0.0.0-20200107162124-548cf772de50
go: finding gopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c
go: finding github.com/Azure/go-autorest/logger v0.2.0
go: finding github.com/Azure/go-autorest/autorest/azure/cli v0.3.1
go: finding github.com/dgrijalva/jwt-go v3.2.0+incompatible
go: finding github.com/mattn/go-ieproxy v0.0.0-20190702010315-6dee0af9227d
go: finding github.com/dimchansky/utfbom v1.1.0
go: finding golang.org/x/crypto v0.0.0-20200728195943-123391ffb6de
go: finding github.com/golang/protobuf v1.3.2
go: finding github.com/google/gofuzz v1.1.0
go: finding github.com/googleapis/gnostic v0.3.1
go: finding github.com/mitchellh/go-homedir v1.1.0
go: finding golang.org/x/net v0.0.0-20191209160850-c0dbc17a3553
go: finding gopkg.in/inf.v0 v0.9.1
go: finding gopkg.in/yaml.v2 v2.2.8
go: finding k8s.io/klog v1.0.0
go: finding github.com/json-iterator/go v1.1.8
go: finding sigs.k8s.io/structured-merge-diff/v3 v3.0.0
go: finding github.com/modern-go/reflect2 v1.0.1
go: finding golang.org/x/text v0.3.2
go: finding github.com/modern-go/concurrent v0.0.0-20180306012644-bacd9c7ef1dd
go: finding sigs.k8s.io/yaml v1.2.0
go: finding golang.org/x/time v0.0.0-20190308202827-9d24e82272b4
go: finding golang.org/x/oauth2 v0.0.0-20200107190931-bf48bf16ab8d
go: finding k8s.io/utils v0.0.0-20200324210504-a9aa75ae1b89
go: finding github.com/gruntwork-io/gruntwork-cli v0.5.1
go: finding github.com/imdario/mergo v0.3.7
go: finding github.com/go-errors/errors v1.0.2-0.20180813162953-d98b870cc4e0
go: finding github.com/spf13/pflag v1.0.5
go: finding github.com/urfave/cli v1.22.1
go: finding github.com/aws/aws-sdk-go v1.27.1
go: finding github.com/cpuguy83/go-md2man/v2 v2.0.0
go: finding github.com/jmespath/go-jmespath v0.0.0-20180206201540-c2b33e8439af
go: finding github.com/russross/blackfriday/v2 v2.0.1
go: finding github.com/shurcooL/sanitized_anchor_name v1.0.0
go: finding cloud.google.com/go v0.51.0
go: finding github.com/go-sql-driver/mysql v1.4.1
go: finding github.com/docker/spdystream v0.0.0-20181023171402-6480d4af844c
go: finding github.com/pquerna/otp v1.2.0
go: finding github.com/boombuler/barcode v1.0.1-0.20190219062509-6c824513bacc
=== RUN   TestClient
--- FAIL: TestClient (0.00s)
panic: stat /tekton/home/.kube/config: no such file or directory [recovered]
	panic: stat /tekton/home/.kube/config: no such file or directory

goroutine 8 [running]:
testing.tRunner.func1(0xc0000e8700)
	/usr/local/go/src/testing/testing.go:874 +0x3a3
panic(0x15ed800, 0xc000325320)
	/usr/local/go/src/runtime/panic.go:679 +0x1b2
github.com/jenkins-x/terraform-azurerm-**/test.TestClient(0xc0000e8700)
	/workspace/source/test/k8s_test.go:24 +0x35f
testing.tRunner(0xc0000e8700, 0x1824138)
	/usr/local/go/src/testing/testing.go:909 +0xc9
created by testing.(*T).Run
	/usr/local/go/src/testing/testing.go:960 +0x350
FAIL	github.com/jenkins-x/terraform-azurerm-**/test	0.013s
FAIL
make: *** [test] Error 1
[31m
Pipeline failed on stage 'ci' : container 'step-terratest'. The execution of the pipeline has stopped.[0m
